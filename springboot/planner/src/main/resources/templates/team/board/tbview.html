<!DOCTYPE html>
<html xmlns:th="http://www.thymeleaf.org" xmlns:layout="http://www.ultraq.net.nz/thymeleaf/layout" xmlns:sec="http://www.thymeleaf.org/extras/spring-security">
<head>
	<meta charset="UTF-8"/>
	<title th:text="${dto.tb_title}"></title>
	<script src="https://ajax.googleapis.com/ajax/libs/jquery/3.5.1/jquery.min.js"></script>
	<style>
		*{
			margin:0;
			padding:0;
		}
		body{
			width:1300px;
			margin:0 auto;
			padding:25px 0px;
		}
		#title{
			padding:5px 15px;
		}
		#content{
			padding:15px;
		}
		.linkbox a, #reply_refresh{
			padding:1px;
			margin-left:4px;
			color:blue;
			cursor:pointer;
			text-decoration: none;
		}
		.linkbox a{
			float:right;
		}
		.linkbox:after{
		  content:'';
		  display:block;
		  clear:both;
		}
		#modal {
			display:none;
			width:100vw;
			height:100vh;
			background-color:rgba(0, 0, 0, 0.25);
			position:fixed;
			top:0;
			left:0;
		}
		#modal_body {
			width:400px;
			height:300px;
			position:absolute;
			top:calc(50vh - 150px);
			left:calc(50% - 200px);
			background-color: white;
		}
		#modal_btns{
			width:100%;
			text-align:center;
			position: absolute;
			bottom:50px;
			
		}
		#modal_btns button{
			padding:2px 4px;
			margin:5px;
		}
		#modal_body h2{
			width:100%;
			text-align:center;
			position: absolute;
			top:70px;
		}
		#reply_form {
			margin-top:8px;
		}
		#reply_form textarea {
			width:600px;
			height:100px;
			overflow:hidden;
			resize: none;
		}
	</style>
</head>
<body>
<span th:text="${dto.tb_category}"></span>
<h2 id="title" th:text="${dto.tb_title}"></h2>
<p>
	<!-- 작성자 이름/별명 -->
	<span>작성시간 : [[${#temporals.format(dto.tb_reg, 'yyyy-MM-dd HH:mm:ss')}]]</span>
	<span class="linkbox">
		<a href="#replys">댓글로</a>
	</span>
</p>
<hr>
<div id="content">
<th:block th:utext="${dto.tb_content}"></th:block>
<!-- 나중에 schedule_id, vote_id 있으면 출력 -->
</div>
<div>
	<span>
		<b>댓글</b> : ~~개
		<a id="reply_refresh" href="javascript:void(0);">댓글 새로고침</a>
	</span>
	<span class="linkbox"> <!--/* float:right 때문에 순서 반대 */-->
		<a id="check_delete" href="javascript:void(0);">삭제</a> <!-- 모달 띄우고 예, 아니오, 예 누르면 요청 post로 처리 -->
		<a th:href="@{|modify?team_id=${dto.team_id}&tb_id=${dto.team_board_id}&team_member_id=${dto.team_member_id}|}">수정</a>
		<a href="#content">본문으로</a>
		<a th:href="@{|list?team_id=${dto.team_id}&ca=${ca}&ps=${ps}&so=${so}&search=${search}&pageNum=${pageNum}|}">목록</a>
	</span>
</div>
<hr>
<div id="replys">
	<div><em>th:each로 댓글 출력하기</em></div>
	<form id="reply_form" onsubmit="return false;">
		<textarea rows="" cols=""></textarea>
	</form>
</div>

<div id="modal">
	<div id="modal_body">
		<h2>게시글을 삭제하시겠습니까?</h2>
		<p id="modal_btns">
			<button type="button" id="board_delete" th:data-_csrf="${_csrf.token}" 
			th:data-tb_id="${dto.team_board_id}" th:data-team_id="${dto.team_id}"
			>삭제</button><button type="button" id="modal_close">취소</button>
		</p>
	</div>
</div>
<script>
	const modal = document.getElementById('modal');
	const check_delete = document.getElementById('check_delete');
	const modal_close = document.getElementById('modal_close');
	
	check_delete.addEventListener('click', function(){
		modal.style.display = 'block';
	})
	modal_close.addEventListener('click', function(){
		modal.style.display = 'none';
	})
	$("#board_delete").on("click", function(){
		let data = $(this).data();
		$.ajax({
			type:"post",
			url:"/team/board/delete",
			data: data,
			success: function(result){
				window.location = result;
			},
		});
	});
</script>
</body>
</html>